(this["webpackJsonppwa-demo"]=this["webpackJsonppwa-demo"]||[]).push([[0],[,,function(e,t,n){e.exports={wrapper:"TaskCard_wrapper__2pwFH",milestones:"TaskCard_milestones__aQ1Fm",milestone:"TaskCard_milestone__1ZgSQ",complete:"TaskCard_complete__2qkrJ",photos:"TaskCard_photos__2EWg6",photo:"TaskCard_photo__qubp1",addPhoto:"TaskCard_addPhoto__2k0jz",remove:"TaskCard_remove__5Qf8u",buttons:"TaskCard_buttons__1SyS5",completeButton:"TaskCard_completeButton__oOeo0",resetButton:"TaskCard_resetButton__3Nj-C"}},,,,,,function(e,t,n){e.exports={wrapper:"TakePhoto_wrapper__2IAC6",video:"TakePhoto_video__3jRgH",buttons:"TakePhoto_buttons__10Dcp",backButton:"TakePhoto_backButton__mVHoW",takePhotoButton:"TakePhoto_takePhotoButton__3jwSX"}},,,,,,,,function(e,t,n){e.exports={wrapper:"App_wrapper__2yWJv"}},function(e,t,n){},function(e,t,n){e.exports={wrapper:"TasksList_wrapper__19HVx"}},,,,,function(e,t,n){},function(e,t,n){},,,function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(15),s=n.n(r),c=(n(23),n(24),n(16)),i=n.n(c),d=n(5),l=n(6),u=n(3),h=function(e,t){switch(t.type){case"LoadTasks":return Object(u.a)(Object(u.a)({},e),{},{tasks:Object(l.a)(t.value)});case"AddPhoto":var n=e.tasks.find((function(e){return e.id===t.taskId}));return n?(n.photos=[].concat(Object(l.a)(n.photos||[]),[t.photo]),Object(u.a)(Object(u.a)({},e),{},{tasks:Object(l.a)(e.tasks)})):e;case"RemovePhoto":var a=e.tasks.find((function(e){return e.id===t.taskId}));return a?(a.photos.splice(t.index,1),Object(u.a)(Object(u.a)({},e),{},{tasks:Object(l.a)(e.tasks)})):e;case"CompleteStep":var o=e.tasks.find((function(e){return e.id===t.taskId}));return o?o.workEnd?e:(o.workStart?o.workEnd=(new Date).toISOString():o.travelEnd?o.workStart=(new Date).toISOString():o.travelStart?o.travelEnd=(new Date).toISOString():o.travelStart=(new Date).toISOString(),Object(u.a)(Object(u.a)({},e),{},{tasks:Object(l.a)(e.tasks)})):e;case"ResetTask":var r=e.tasks.find((function(e){return e.id===t.taskId}));return r?(r.workEnd=void 0,r.workStart=void 0,r.travelEnd=void 0,r.travelStart=void 0,Object(u.a)(Object(u.a)({},e),{},{tasks:Object(l.a)(e.tasks)})):e;default:return e}},j={tasks:[]},b=n(0),p=o.a.createContext([j,function(){}]),f=function(e){var t=e.children,n=o.a.useReducer(h,j),a=Object(d.a)(n,2),r=a[0],s=a[1];return Object(b.jsx)(p.Provider,{value:[r,s],children:t})},v=n(13),k=n(7),O=n.n(k),m=n(17),w=n.n(m),x=n(4),_=n.n(x),g=n(18),S=n.n(g),C=n(2),P=n.n(C),T=function(e){if(!e)return"";try{var t=new Date(e);return"".concat(t.getHours(),":").concat(t.getMinutes().toString().padStart(2,"0"))}catch(n){return""}},N=function(e){var t=e.className,n=e.task,a=e.onPhotoRemove,o=e.onCompleteStep,r=e.onPhotoAddStart,s=e.onReset;return Object(b.jsxs)("div",{className:_()(P.a.wrapper,t),children:[Object(b.jsxs)("header",{children:[Object(b.jsx)("div",{children:Object(b.jsx)("b",{children:n.location})}),Object(b.jsx)("div",{children:n.description})]}),Object(b.jsxs)("div",{className:P.a.milestones,children:[Object(b.jsxs)("ul",{children:[Object(b.jsxs)("li",{className:_()(P.a.milestone,n.travelStart&&P.a.complete),children:[Object(b.jsx)("b",{children:"Travel started "}),Object(b.jsx)("span",{children:T(n.travelStart)})]}),n.travelStart&&Object(b.jsxs)("li",{className:_()(P.a.milestone,n.travelEnd&&P.a.complete),children:[Object(b.jsx)("b",{children:"Travel finished "}),Object(b.jsx)("span",{children:T(n.travelEnd)})]}),n.travelEnd&&Object(b.jsxs)("li",{className:_()(P.a.milestone,n.workStart&&P.a.complete),children:[Object(b.jsx)("b",{children:"Work started "}),Object(b.jsx)("span",{children:T(n.workStart)})]}),n.workStart&&Object(b.jsxs)("li",{className:_()(P.a.milestone,n.workEnd&&P.a.complete),children:[Object(b.jsx)("b",{children:"Work finished "}),Object(b.jsx)("span",{children:T(n.workEnd)})]})]}),Object(b.jsxs)("div",{className:P.a.buttons,children:[Object(b.jsx)("button",{className:P.a.completeButton,onClick:o,disabled:!!n.workEnd,children:"\u25b6"}),Object(b.jsx)("button",{className:P.a.resetButton,onClick:s,children:"Reset"})]})]}),Object(b.jsxs)("div",{className:P.a.photos,children:[n.photos&&n.photos.map((function(e,t){return Object(b.jsxs)("div",{className:P.a.photo,onClick:function(){return a(t)},children:[Object(b.jsx)("img",{src:e}),Object(b.jsx)("span",{className:P.a.remove,children:"\xd7"})]})})),Object(b.jsx)("div",{className:P.a.addPhoto,onClick:r,children:"+"})]})]})},E=Object(a.memo)(N),y=n(8),R=n.n(y),I=function(e){var t=e.onPhoto,n=e.onCancel,o=Object(a.useRef)(null),r=Object(a.useState)(null),s=Object(d.a)(r,2),c=s[0],i=s[1],l=Object(a.useState)(!1),u=Object(d.a)(l,2),h=u[0],j=u[1],p=Object(a.useCallback)(Object(v.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.current){e.next=9;break}return o.current.addEventListener("loadedmetadata",(function(){console.log("video ready"),j(!0)})),o.current.addEventListener("ended",(function(){console.log("stream ended"),i(null),j(!1)})),e.next=5,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}});case 5:t=e.sent,console.log("setting stream"),i(t),o.current.srcObject=t;case 9:case"end":return e.stop()}}),e)}))),[]);return Object(a.useEffect)((function(){return c||p(),function(){c&&c.getTracks().forEach((function(e){e.stop()}))}}),[p,c]),Object(b.jsxs)("div",{className:_()(R.a.wrapper),children:[Object(b.jsx)("video",{className:R.a.video,ref:o,autoPlay:!0,muted:!0,playsInline:!0}),Object(b.jsxs)("div",{className:R.a.buttons,children:[Object(b.jsx)("button",{className:R.a.backButton,onClick:n,disabled:!h,children:"Back"}),Object(b.jsx)("button",{className:R.a.takePhotoButton,onClick:function(){var e=o.current;if(e){var n=document.createElement("canvas");n.height=e.videoHeight/2,n.width=e.videoWidth/2;var a=n.getContext("2d");if(a){a.drawImage(e,0,0,e.videoWidth/2,e.videoHeight/2);var r=n.toDataURL("image/webp",.8);t(r)}}},disabled:!h,children:"Take photo!"})]})]})},B=function(e){var t=e.className,n=e.onPhotoRemove,o=e.tasks,r=e.onCompleteStep,s=e.onPhotoAdd,c=e.onTaskReset,i=Object(a.useState)(null),l=Object(d.a)(i,2),u=l[0],h=l[1];return Object(b.jsxs)("div",{className:_()(S.a.wrapper,t),children:[Object(b.jsx)("ul",{children:o.map((function(e){return Object(b.jsx)("li",{children:Object(b.jsx)(E,{task:e,onPhotoRemove:function(t){return n(e.id,t)},onPhotoAddStart:function(){return h(e.id)},onCompleteStep:function(){return r(e.id)},onReset:function(){return c(e.id)}})})}))}),u&&Object(b.jsx)(I,{onCancel:function(){return h(null)},onPhoto:function(e){s(u,e),h(null)}})]})},W=n(9),A=n(10),D=Object(W.a)((function e(t){Object(A.a)(this,e),this.value=t,this.type="LoadTasks"})),L=Object(W.a)((function e(t,n){Object(A.a)(this,e),this.taskId=t,this.photo=n,this.type="AddPhoto"})),H=Object(W.a)((function e(t,n){Object(A.a)(this,e),this.taskId=t,this.index=n,this.type="RemovePhoto"})),U=Object(W.a)((function e(t){Object(A.a)(this,e),this.taskId=t,this.type="CompleteStep"})),J=Object(W.a)((function e(t){Object(A.a)(this,e),this.taskId=t,this.type="ResetTask"})),M=function(){var e=Object(a.useContext)(p),t=Object(d.a)(e,2),n=t[0].tasks,o=t[1];Object(a.useEffect)((function(){function e(){return e=Object(v.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.npoint.io/3f4c4bcb193491b0b146");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o(new D(n));case 7:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[o]);return Object(b.jsx)("div",{className:w.a.wrapper,children:Object(b.jsx)(B,{tasks:n,onPhotoRemove:function(e,t){return o(new H(e,t))},onPhotoAdd:function(e,t){o(new L(e,t))},onCompleteStep:function(e){return o(new U(e))},onTaskReset:function(e){return o(new J(e))}})})},Q=function(){return Object(b.jsx)("div",{className:i.a.wrapper,children:Object(b.jsx)(f,{children:Object(b.jsx)(M,{})})})},q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function F(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(Q,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/pwa-demo",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/pwa-demo","/service-worker.js");q?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):F(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):F(t,e)}))}}()}],[[27,1,2]]]);
//# sourceMappingURL=main.f66e0615.chunk.js.map